<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | LanePeons</title>
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="shortcut icon" href="TemplateData/favicon.ico" />
    <script src="TemplateData/UnityProgress.js"></script>
	<script src='socket.io/socket.io.js'></script>
    <script>
        var game = io("http://lanepeons-firewatch.rhcloud.com:8000/game", {query : 'username=Vasilica'});
        var socket = io("http://lanepeons-firewatch.rhcloud.com:8000");

        function registerGameCallback(eventName, callback)
        {
            if(eventName != null && eventName.length > 1)
                game.on(eventName, callback);
        }

        function sendGameMessage(eventName, data)
        {
            if(eventName != null && eventName.length > 1)
                game.emit(eventName, data);
        }

		registerGameCallback('game-start', function(data){
			console.log(data);
			SendMessage ('SocketIO', 'OnGameStart', String(data));
		});
		
		registerGameCallback('player-move', function(data){
			console.log(data);
			console.log(String(data));
			SendMessage ('SocketIO', 'OnPlayerMove', String(data));
		});
		
		function sendData(data)
		{
			sendGameMessage('player-move', data);
		}
		
		function connect()
		{
			sendGameMessage('player-join');
		}
		
        game.on('debug', console.log.bind(console));
        socket.on('error', console.error.bind(console));
        socket.on('message', console.log.bind(console));
        socket.on('debug', console.log.bind(console));
    </script>
  </head>
  <body class="template">
    <p class="header"><span>Unity WebGL Player | </span>LanePeons</p>
    <div class="template-wrap clear">
      <canvas class="emscripten" id="canvas" oncontextmenu="event.preventDefault()" height="600px" width="960px"></canvas>
      <br>
      <div class="logo"></div>
      <div class="fullscreen"><img src="TemplateData/fullscreen.png" width="38" height="38" alt="Fullscreen" title="Fullscreen" onclick="SetFullscreen(1);" /></div>
      <div class="title">LanePeons</div>
    </div>
    <p class="footer">&laquo; created with <a href="http://unity3d.com/" title="Go to unity3d.com">Unity</a> &raquo;</p>
    <script type='text/javascript'>
  var Module = {
    TOTAL_MEMORY: 268435456,
    errorhandler: null,			// arguments: err, url, line. This function must return 'true' if the error is handled, otherwise 'false'
    compatibilitycheck: null,
    dataUrl: "Release/WebGL.data",
    codeUrl: "Release/WebGL.js",
    memUrl: "Release/WebGL.mem",
  };
</script>
<script src="Release/UnityLoader.js"></script>

  </body>
</html>
